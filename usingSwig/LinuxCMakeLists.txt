cmake_minimum_required(VERSION 3.22)

#See https://stackoverflow.com/questions/31038963/how-do-you-rename-a-library-filename-in-cmake for proper
# way to change name.
# See also:
#  https://stackoverflow.com/questions/65626613/assigning-output-name-based-on-c-header-file-and-cmake-command
# For add_dependencies:
#  https://stackoverflow.com/questions/24614624/in-cmake-how-can-i-make-a-target-depend-on-another-target
# See CMake documentation

project(testingSwig)

add_custom_target(swigStuff
        COMMAND swig -c++ -python ../firstSwig.i
)
set_target_properties(swigStuff PROPERTIES PREFIX "")
set_target_properties(swigStuff PROPERTIES SUFFIX "")
set_target_properties(swigStuff PROPERTIES RUNTIME_OUTPUT_DIRECTORY ..)

add_library(first SHARED firstSwig.cpp ${PROJECT_SOURCE_DIR}/firstSwig_wrap.cxx)

add_dependencies(first swigStuff)

set_target_properties(first PROPERTIES PREFIX "_")
set_target_properties(first PROPERTIES SUFFIX ".so")
set_target_properties(first PROPERTIES LIBRARY_OUTPUT_DIRECTORY ..)

target_include_directories(first PUBLIC /usr/include/python3.10/)